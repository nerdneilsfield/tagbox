# 项目名称：TagBox - 本地文件智能标签管理工具

## 一、项目背景与目标

在多平台使用、文件类型多样化与信息归档需求不断增强的今天，传统操作系统的文件夹体系已难以满足用户对文件的灵活组织与快速检索需求。TagBox 致力于构建一个"无需服务端、可结构化、轻量扩展"的本地文件管理工具。

项目目标如下：

* 实现基于标签、分类、元信息的文件管理与搜索
* 保持完全本地运行，无需服务端、支持同步盘部署
* 提供最小化 GUI、TUI 和 CLI 操作入口，简洁高效
* 可未来扩展 AI 进行内容理解与标签推荐
* 支持文件语义链接、访问日志与多种外部工具集成

## 二、核心功能概述

### 1. 文件导入与分类

* 支持用户手动导入文件或批量导入目录
* 自动生成文件唯一 ID（UUID）与 hash（初始与当前）
* 支持元信息提取器（文件名/PDF/meta.json）预填字段
* 可配置分类目录结构（最大3层）与重命名模板
* 支持填写元信息：标题、作者、年份、出版社、来源、摘要、多标签、唯一分类

### 2. 元数据与文件管理

* 文件元数据存入 SQLite，支持修改、补全与维护
* 支持层级标签管理（独立表）、作者笔名归一、分类多层结构
* 每个文件可添加多个摘要条目
* 支持建立文件之间的语义关系（引用、派生等）
* 支持软删除机制与删除延迟清理

### 3. 搜索与访问

* 提供模糊搜索功能（基于 SQLite + Signal FTS5 Extension，支持中文分词）
* 支持 DSL 查询语法（如 `tag:Rust author:张三 -tag:旧版`）
* 支持分页、排序、自定义过滤器
* 搜索结果支持返回文件路径，由前端决定打开、复制或跳转行为

### 4. 系统结构与运行方式

* 核心逻辑为独立 Rust 库（tagbox-core，支持 async）
* 提供 CLI（支持 --json/--stdio）、TUI 和 GUI（fltk）
* 所有数据本地存储，兼容同步盘使用
* 最小化依赖，无 Electron，无缩略图处理

## 三、对外交互接口设计

### 1. URL Scheme 支持（跨工具跳转）

* `tagbox://open?id=abc123` 打开文件
* `tagbox://search?q=tag:Rust` 触发搜索
* `tagbox://edit?id=abc123` 编辑元信息

### 2. CLI 命令调用

```bash
tagbox-cli import <file>
tagbox-cli search --tag Rust --author 张三 --json
tagbox-cli path abc123               # 获取文件完整路径
```

### 3. Stdio 模式（集成插件）

```bash
echo '{"cmd": "search", "query": "tag:Rust"}' | tagbox-cli --stdio
```

* 支持命令：`import` / `search` / `path` / `edit`

## 四、版本计划

### v0.1 MVP

* 实现导入、分类、重命名、基础元信息填充
* 支持基本搜索 + 系统路径获取
* CLI 与 GUI 原型初步成型

### v0.2

* 简化 DSL 查询语法支持（pest）
* 文件双链功能加入
* 可批量修改、编辑元信息

### v0.3+

* AI 辅助摘要生成与 tag 建议（Claude/GPT）
* 可视化文件网络图（可选）
* 插件机制初探（导入器、处理器）
* 热门文件追踪与访问日志分析

## 五、目标用户画像

* 熟练使用本地文件系统，重视数据控制与私密性
* 有归档、管理、查找、笔记整理等需求
* 希望统一管理 PDF、图片、文档等多种类型资料
* 不满足于传统文件夹体系，寻求语义级组织
* 倾向结构化、模块化的轻量型工具，而非臃肿平台
